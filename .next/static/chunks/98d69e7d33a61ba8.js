(globalThis.TURBOPACK||(globalThis.TURBOPACK=[])).push(["object"==typeof document?document.currentScript:void 0,73079,e=>{"use strict";var s=e.i(43476),t=e.i(71645),a=e.i(55436),r=e.i(63209),n=e.i(94179),i=e.i(63270);let l=[{key:"all",label:"全部"},{key:"student",label:"学生"},{key:"parent",label:"家长"},{key:"internal",label:"内部"}];function o({conversations:e,selectedId:t,onSelect:r,filter:i,onFilterChange:o,searchQuery:d,onSearchChange:m}){return(0,s.jsxs)("div",{className:"w-80 border-r border-slate-200 flex flex-col bg-slate-50/50",children:[(0,s.jsxs)("div",{className:"p-4 border-b border-slate-200 space-y-3",children:[(0,s.jsx)("div",{className:"flex gap-2 overflow-x-auto pb-1",children:l.map(e=>(0,s.jsx)(n.Badge,{variant:i===e.key?"default":"outline",className:"cursor-pointer whitespace-nowrap",onClick:()=>o(e.key),children:e.label},e.key))}),(0,s.jsxs)("div",{className:"relative",children:[(0,s.jsx)(a.Search,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-slate-400",size:14}),(0,s.jsx)("input",{type:"text",value:d,onChange:e=>m(e.target.value),placeholder:"搜索会话...",className:"w-full pl-9 pr-3 py-2 text-sm border border-slate-200 rounded-lg focus:outline-none focus:ring-2 focus:ring-brand-500 bg-white"})]})]}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:[e.map(e=>(0,s.jsx)(c,{conversation:e,isSelected:t===e.id,onClick:()=>r(e.id)},e.id)),0===e.length&&(0,s.jsx)("div",{className:"p-8 text-center text-slate-400 text-sm",children:"暂无会话"})]})]})}function c({conversation:e,isSelected:t,onClick:a}){return(0,s.jsxs)("div",{onClick:a,className:`p-3 flex gap-3 cursor-pointer border-b border-slate-100 hover:bg-slate-100 transition-colors relative ${t?"bg-brand-50/50 border-l-4 border-l-brand-500":""}`,children:[(0,s.jsxs)("div",{className:"relative flex-shrink-0",children:[(0,s.jsx)(i.Avatar,{className:"h-10 w-10",children:(0,s.jsx)(i.AvatarFallback,{className:"text-xs bg-slate-200",children:e.name.slice(0,2)})}),e.isOverdue&&(0,s.jsx)("div",{className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 rounded-full border-2 border-white flex items-center justify-center animate-pulse",children:(0,s.jsx)(r.AlertCircle,{size:10,className:"text-white"})})]}),(0,s.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,s.jsxs)("div",{className:"flex justify-between items-start mb-1",children:[(0,s.jsx)("h4",{className:"text-sm font-medium text-slate-900 truncate",children:e.name}),(0,s.jsx)("span",{className:"text-xs text-slate-400 whitespace-nowrap ml-2",children:e.lastMessageTime})]}),(0,s.jsx)("p",{className:"text-xs text-slate-500 truncate",children:e.lastMessage}),e.tags&&e.tags.length>0&&(0,s.jsx)("div",{className:"flex gap-1 mt-1.5",children:e.tags.slice(0,2).map(e=>(0,s.jsx)("span",{className:"text-[10px] bg-slate-200 text-slate-600 px-1.5 py-0.5 rounded",children:e},e))})]}),e.unreadCount>0&&(0,s.jsx)("div",{className:"absolute right-3 top-3",children:(0,s.jsx)("span",{className:"w-5 h-5 bg-brand-600 text-white text-[10px] rounded-full flex items-center justify-center",children:e.unreadCount})}),e.isOverdue&&(0,s.jsx)("div",{className:"absolute right-2 bottom-2",children:(0,s.jsx)("span",{className:"text-[10px] text-red-500 font-bold bg-red-50 px-1.5 py-0.5 rounded border border-red-100",children:"服务超时"})})]})}var d=e.i(75254);let m=(0,d.default)("EllipsisVertical",[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]]);var x=e.i(70756),u=e.i(16715);let h=(0,d.default)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]),p=(0,d.default)("Sparkles",[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]]);var g=e.i(67881);function f({conversation:e,messages:t,draft:a,onDraftChange:r,onCopyDraft:n}){return e?(0,s.jsxs)("div",{className:"flex-1 flex flex-col bg-[#F5F6F8]",children:[(0,s.jsx)(b,{conversation:e}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:[(0,s.jsx)("div",{className:"flex justify-center mb-4",children:(0,s.jsxs)("span",{className:"text-xs font-medium text-slate-400 flex items-center gap-1.5 bg-white px-3 py-1 rounded-full shadow-sm",children:[(0,s.jsx)(u.RefreshCw,{size:12,className:"animate-spin"})," 正在同步企微数据..."]})}),t.map(e=>(0,s.jsx)(y,{message:e},e.id))]}),(0,s.jsx)(v,{draft:a,onDraftChange:r,onCopyDraft:n})]}):(0,s.jsx)("div",{className:"flex-1 flex items-center justify-center bg-[#F5F6F8]",children:(0,s.jsx)("div",{className:"text-center text-slate-400",children:(0,s.jsx)("p",{children:"选择一个会话开始"})})})}function b({conversation:e}){return(0,s.jsxs)("div",{className:"h-14 border-b border-slate-200 flex items-center justify-between px-4 bg-white",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsx)("h3",{className:"font-semibold text-slate-900",children:e.name}),e.isOverdue&&(0,s.jsx)(n.Badge,{variant:"destructive",className:"animate-pulse",children:"服务超时"}),e.clientStatus&&(0,s.jsx)(n.Badge,{variant:"signed"===e.clientStatus?"success":"secondary",children:"signed"===e.clientStatus?"已签约":"未签约"})]}),(0,s.jsxs)("div",{className:"flex items-center gap-3",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 text-xs text-slate-400 bg-slate-50 px-2 py-1 rounded",children:[(0,s.jsx)(x.Lock,{size:12})," 只读模式"]}),(0,s.jsx)("button",{className:"text-slate-400 hover:text-slate-600",children:(0,s.jsx)(m,{size:18})})]})]})}function y({message:e}){return(0,s.jsx)("div",{className:`flex ${e.isMe?"justify-end":"justify-start"}`,children:(0,s.jsxs)("div",{className:`flex gap-2 max-w-[70%] ${e.isMe?"flex-row-reverse":""}`,children:[(0,s.jsx)(i.Avatar,{className:"h-8 w-8 flex-shrink-0",children:(0,s.jsx)(i.AvatarFallback,{className:`text-xs ${e.isMe?"bg-brand-100 text-brand-700":"bg-slate-200"}`,children:e.senderName.slice(0,1)})}),(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:`text-xs text-slate-400 mb-1 ${e.isMe?"text-right":""}`,children:[e.senderName," · ",e.timestamp]}),(0,s.jsx)("div",{className:`px-4 py-2.5 rounded-2xl text-sm ${e.isMe?"bg-brand-600 text-white rounded-tr-sm":"bg-white text-slate-800 rounded-tl-sm shadow-sm"}`,children:e.content})]})]})})}function v({draft:e,onDraftChange:t,onCopyDraft:a}){return(0,s.jsxs)("div",{className:"border-t border-slate-200 bg-white p-4",children:[(0,s.jsxs)("div",{className:"text-xs text-slate-400 mb-2 flex items-center gap-1",children:[(0,s.jsx)(p,{size:12})," 回复草稿区（复制后到企微发送）"]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsx)("textarea",{value:e,onChange:e=>t(e.target.value),placeholder:"AI 建议的回复会显示在这里，也可手动编辑...",className:"flex-1 border border-slate-200 rounded-lg px-3 py-2 text-sm resize-none focus:outline-none focus:ring-2 focus:ring-brand-500",rows:2}),(0,s.jsxs)(g.Button,{onClick:a,disabled:!e,className:"self-end",children:[(0,s.jsx)(h,{size:16,className:"mr-1"})," 复制"]})]})]})}let j=(0,d.default)("CircleUser",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}],["path",{d:"M7 20.662V19a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v1.662",key:"154egf"}]]),N=(0,d.default)("BrainCircuit",[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]]);var k=e.i(78583),w=e.i(32095),A=e.i(95468),S=e.i(78894);let _=(0,d.default)("Send",[["path",{d:"M14.536 21.686a.5.5 0 0 0 .937-.024l6.5-19a.496.496 0 0 0-.635-.635l-19 6.5a.5.5 0 0 0-.024.937l7.93 3.18a2 2 0 0 1 1.112 1.11z",key:"1ffxy3"}],["path",{d:"m21.854 2.147-10.94 10.939",key:"12cjpa"}]]);var C=e.i(78917);let T=(0,d.default)("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]]);var z=e.i(25652);let P=(0,d.default)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),M=(0,d.default)("Minus",[["path",{d:"M5 12h14",key:"1ays0h"}]]),$=[{key:"profile",label:"客户画像",icon:j},{key:"ai",label:"AI教练",icon:N},{key:"feed",label:"素材推送",icon:k.FileText}];function I({conversation:e,aiAnalysis:t,materials:a,activeTab:r,onTabChange:n,onUseScript:i,onRefreshAnalysis:l,isAnalysisLoading:o}){return(0,s.jsxs)("div",{className:"w-80 border-l border-slate-200 flex flex-col bg-white",children:[(0,s.jsx)("div",{className:"flex border-b border-slate-200",children:$.map(e=>{let t=e.icon;return(0,s.jsxs)("button",{onClick:()=>n(e.key),className:`flex-1 py-3 text-xs font-medium flex items-center justify-center gap-1.5 border-b-2 transition-colors ${r===e.key?"border-brand-500 text-brand-600 bg-brand-50/50":"border-transparent text-slate-500 hover:text-slate-700"}`,children:[(0,s.jsx)(t,{size:14}),e.label]},e.key)})}),(0,s.jsxs)("div",{className:"flex-1 overflow-y-auto",children:["profile"===r&&(0,s.jsx)(U,{conversation:e}),"ai"===r&&(0,s.jsx)(F,{analysis:t,onUseScript:i,onRefresh:l,isLoading:o}),"feed"===r&&(0,s.jsx)(B,{materials:a})]})]})}function U({conversation:e}){return e?(0,s.jsxs)("div",{className:"divide-y divide-slate-100",children:[(0,s.jsx)(R,{conversation:e}),e.serviceProject&&(0,s.jsx)(E,{conversation:e}),(0,s.jsx)(O,{conversation:e}),e.serviceTeam&&(0,s.jsx)(K,{team:e.serviceTeam})]}):(0,s.jsx)("div",{className:"p-8 text-center text-slate-400 text-sm",children:"选择会话查看客户画像"})}function R({conversation:e}){return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsxs)("div",{className:"flex items-center gap-3 mb-4",children:[(0,s.jsx)(i.Avatar,{className:"h-12 w-12",children:(0,s.jsx)(i.AvatarFallback,{className:"bg-brand-100 text-brand-700",children:e.name.slice(0,2)})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"font-semibold text-slate-900",children:e.name}),e.grade&&(0,s.jsxs)("span",{className:"text-xs text-slate-500 flex items-center gap-1 mt-1",children:[(0,s.jsx)(w.GraduationCap,{size:12})," ",e.grade]})]})]}),e.tags&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1.5",children:e.tags.map(e=>(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:e},e))})]})}function E({conversation:e}){let t=(e=>{switch(e){case"critical":return{color:"bg-red-50 text-red-700 border-red-200",icon:(0,s.jsx)(r.AlertCircle,{size:14,className:"text-red-500"}),label:"风险"};case"attention":return{color:"bg-amber-50 text-amber-700 border-amber-200",icon:(0,s.jsx)(S.AlertTriangle,{size:14,className:"text-amber-500"}),label:"关注"};default:return{color:"bg-emerald-50 text-emerald-700 border-emerald-200",icon:(0,s.jsx)(A.CheckCircle2,{size:14,className:"text-emerald-500"}),label:"正常"}}})(e.riskStatus);return(0,s.jsxs)("div",{className:"p-4 space-y-3",children:[(0,s.jsx)("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider",children:"服务状态"}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"申请方向"}),(0,s.jsx)("span",{className:"font-medium text-slate-900",children:e.serviceProject})]}),(0,s.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"服务阶段"}),(0,s.jsx)("span",{className:"font-medium text-slate-900",children:e.serviceStage})]}),void 0!==e.serviceProgress&&(0,s.jsxs)("div",{children:[(0,s.jsxs)("div",{className:"flex justify-between text-sm mb-1",children:[(0,s.jsx)("span",{className:"text-slate-500",children:"服务进度"}),(0,s.jsxs)("span",{className:"font-bold text-brand-600",children:[e.serviceProgress,"%"]})]}),(0,s.jsx)("div",{className:"w-full h-1.5 bg-slate-100 rounded-full overflow-hidden",children:(0,s.jsx)("div",{className:"h-full bg-brand-500 rounded-full",style:{width:`${e.serviceProgress}%`}})})]}),(0,s.jsxs)("div",{className:`flex items-center justify-between p-2.5 rounded-lg border ${t.color}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[t.icon,(0,s.jsx)("span",{className:"text-xs font-bold",children:"风险等级"})]}),(0,s.jsx)("span",{className:"text-xs font-bold",children:t.label})]})]})]})}function O({conversation:e}){let t=[e.nextKeyNode&&{label:e.nextKeyNode.label,date:e.nextKeyNode.date,active:!0},e.lastFollowUp&&{label:"最近跟进",date:e.lastFollowUp},e.contractDate&&{label:"签约时间",date:e.contractDate},e.joinDate&&{label:"添加时间",date:e.joinDate}].filter(Boolean);return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"关键时间轴"}),(0,s.jsx)("div",{className:"relative border-l-2 border-slate-100 ml-2 space-y-4",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"ml-4 relative",children:[(0,s.jsx)("div",{className:`absolute -left-[21px] top-0.5 w-3 h-3 rounded-full border-2 border-white ${e.active?"bg-brand-500":"bg-slate-200"}`}),(0,s.jsx)("div",{className:`text-xs ${e.active?"font-bold text-brand-600":"font-medium text-slate-500"}`,children:e.label}),(0,s.jsx)("div",{className:`text-xs ${e.active?"text-slate-500":"text-slate-400"}`,children:e.date})]},t))})]})}function K({team:e}){let t=[e.consultant&&{name:e.consultant,role:"顾问",color:"bg-blue-100 text-blue-700",short:"顾"},e.leadTutor&&{name:e.leadTutor,role:"主导师",color:"bg-purple-100 text-purple-700",short:"主"},e.associateTutor&&{name:e.associateTutor,role:"协作导师",color:"bg-slate-100 text-slate-700",short:"协"}].filter(Boolean);return(0,s.jsxs)("div",{className:"p-4",children:[(0,s.jsx)("h5",{className:"text-xs font-bold text-slate-400 uppercase tracking-wider mb-3",children:"服务团队"}),(0,s.jsx)("div",{className:"space-y-2",children:t.map((e,t)=>(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsx)(i.Avatar,{className:"h-6 w-6",children:(0,s.jsx)(i.AvatarFallback,{className:`text-[10px] ${e.color}`,children:e.short})}),(0,s.jsx)("span",{className:"text-sm text-slate-700",children:e.name}),(0,s.jsx)("span",{className:"text-xs text-slate-400",children:e.role})]},t))})]})}function F({analysis:e,onUseScript:t,onRefresh:a,isLoading:i}){if(i)return(0,s.jsxs)("div",{className:"p-8 text-center",children:[(0,s.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-brand-500 border-t-transparent rounded-full mx-auto mb-3"}),(0,s.jsx)("p",{className:"text-sm text-slate-500",children:"AI 分析中..."})]});if(!e)return(0,s.jsxs)("div",{className:"p-8 text-center text-slate-400",children:[(0,s.jsx)(N,{size:32,className:"mx-auto mb-2 opacity-30"}),(0,s.jsx)("p",{className:"text-sm",children:"暂无AI分析建议"}),a&&(0,s.jsxs)("button",{onClick:a,className:"mt-3 text-xs text-brand-600 hover:text-brand-700 flex items-center gap-1 mx-auto",children:[(0,s.jsx)(u.RefreshCw,{size:12})," 触发分析"]})]});let l={positive:(0,s.jsx)(z.TrendingUp,{size:14,className:"text-emerald-500"}),negative:(0,s.jsx)(P,{size:14,className:"text-red-500"}),neutral:(0,s.jsx)(M,{size:14,className:"text-slate-400"}),mixed:(0,s.jsx)(r.AlertCircle,{size:14,className:"text-amber-500"})}[e.sentiment.overall],o={positive:"积极",negative:"消极",neutral:"中性",mixed:"复杂"}[e.sentiment.overall];return(0,s.jsxs)("div",{className:"p-4 space-y-4",children:[a&&(0,s.jsx)("div",{className:"flex justify-end",children:(0,s.jsxs)("button",{onClick:a,className:"text-xs text-slate-500 hover:text-brand-600 flex items-center gap-1",children:[(0,s.jsx)(u.RefreshCw,{size:12})," 重新分析"]})}),(0,s.jsxs)("div",{className:"bg-purple-50 p-4 rounded-xl border border-purple-100",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(N,{size:16,className:"text-purple-600"}),(0,s.jsx)("h4",{className:"text-sm font-bold text-purple-800",children:"意图分析"}),(0,s.jsxs)("span",{className:"text-xs text-purple-500 ml-auto",children:["置信度 ",Math.round(100*e.intent.confidence),"%"]})]}),(0,s.jsx)("p",{className:"text-sm text-purple-700 font-medium",children:e.intent.primary}),e.intent.secondary&&e.intent.secondary.length>0&&(0,s.jsx)("div",{className:"flex gap-1 mt-2",children:e.intent.secondary.map((e,t)=>(0,s.jsx)("span",{className:"text-xs bg-purple-100 text-purple-600 px-2 py-0.5 rounded",children:e},t))})]}),(0,s.jsxs)("div",{className:"bg-slate-50 p-4 rounded-xl border border-slate-200",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[l,(0,s.jsx)("h4",{className:"text-sm font-bold text-slate-700",children:"情绪状态"}),(0,s.jsx)("span",{className:"text-xs text-slate-500 ml-auto",children:o})]}),e.sentiment.emotions.length>0&&(0,s.jsx)("div",{className:"flex flex-wrap gap-1",children:e.sentiment.emotions.map((e,t)=>(0,s.jsx)(n.Badge,{variant:"secondary",className:"text-xs",children:e},t))})]}),e.keyPoints.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"关键信息"}),(0,s.jsx)("div",{className:"space-y-2",children:e.keyPoints.map((e,t)=>(0,s.jsxs)("div",{className:`p-2 rounded-lg border text-sm ${"high"===e.importance?"bg-red-50 border-red-100 text-red-700":"medium"===e.importance?"bg-amber-50 border-amber-100 text-amber-700":"bg-slate-50 border-slate-100 text-slate-600"}`,children:[(0,s.jsx)("div",{className:"font-medium",children:e.topic}),e.context&&(0,s.jsx)("div",{className:"text-xs opacity-75 mt-0.5",children:e.context})]},t))})]}),(0,s.jsxs)("div",{className:`p-3 rounded-xl border ${{low:"bg-emerald-50 border-emerald-200 text-emerald-700",medium:"bg-amber-50 border-amber-200 text-amber-700",high:"bg-orange-50 border-orange-200 text-orange-700",critical:"bg-red-50 border-red-200 text-red-700"}[e.riskAssessment.level]}`,children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,s.jsx)(S.AlertTriangle,{size:14}),(0,s.jsxs)("span",{className:"text-xs font-bold",children:["风险等级：",e.riskAssessment.level.toUpperCase()]})]}),e.riskAssessment.factors.length>0&&(0,s.jsx)("ul",{className:"text-xs space-y-1 ml-5 list-disc",children:e.riskAssessment.factors.map((e,t)=>(0,s.jsx)("li",{children:e},t))}),e.riskAssessment.suggestions.length>0&&(0,s.jsxs)("div",{className:"mt-2 pt-2 border-t border-current/10",children:[(0,s.jsx)("div",{className:"text-xs font-medium mb-1",children:"建议："}),(0,s.jsx)("ul",{className:"text-xs space-y-1 ml-5 list-disc",children:e.riskAssessment.suggestions.map((e,t)=>(0,s.jsx)("li",{children:e},t))})]})]}),e.suggestedReplies.length>0&&(0,s.jsxs)("div",{children:[(0,s.jsx)("h4",{className:"text-xs font-bold text-slate-500 uppercase tracking-wider mb-2",children:"推荐话术"}),(0,s.jsx)("div",{className:"space-y-2",children:e.suggestedReplies.map((e,a)=>(0,s.jsxs)("div",{className:"bg-white p-3 rounded-xl border border-slate-200 hover:border-brand-300 transition-colors",children:[(0,s.jsxs)("div",{className:"flex items-center gap-2 mb-1.5",children:[(0,s.jsxs)("span",{className:"text-xs text-slate-400",children:["语气：",e.tone]}),1===e.priority&&(0,s.jsx)("span",{className:"text-xs bg-brand-100 text-brand-600 px-1.5 py-0.5 rounded",children:"推荐"})]}),(0,s.jsx)("p",{className:"text-sm text-slate-700 leading-relaxed mb-2",children:e.content}),(0,s.jsxs)("button",{onClick:()=>t(e.content),className:"w-full flex items-center justify-center gap-1.5 text-xs font-medium bg-slate-50 text-slate-600 py-1.5 rounded-lg hover:bg-brand-50 hover:text-brand-700 transition-colors",children:[(0,s.jsx)(h,{size:12})," 采纳话术"]})]},a))})]}),(0,s.jsxs)("div",{className:"text-xs text-slate-400 text-center pt-2 border-t border-slate-100",children:["由 ",e.metadata.provider,"/",e.metadata.model," 提供",e.metadata.processingTime&&` \xb7 ${e.metadata.processingTime}ms`]})]})}function B({materials:e}){return(0,s.jsxs)("div",{children:[(0,s.jsx)("div",{className:"px-4 py-3 bg-orange-50/50 border-b border-orange-100",children:(0,s.jsxs)("h4",{className:"text-xs font-bold text-orange-800 flex items-center gap-1",children:[(0,s.jsx)(p,{size:12})," 公众号/视频号更新"]})}),(0,s.jsx)("div",{className:"divide-y divide-slate-100",children:e.map(e=>(0,s.jsxs)("div",{className:"p-4 hover:bg-slate-50 transition-colors",children:[(0,s.jsxs)("div",{className:"flex gap-3 mb-2",children:[(0,s.jsx)("div",{className:`w-14 h-10 rounded flex items-center justify-center flex-shrink-0 ${"video"===e.type?"bg-slate-800":"bg-slate-200"}`,children:"video"===e.type?(0,s.jsx)(T,{size:16,className:"text-white"}):(0,s.jsx)(k.FileText,{size:16,className:"text-slate-500"})}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h5",{className:"text-xs font-bold text-slate-800 line-clamp-2 leading-tight mb-1",children:e.title}),(0,s.jsxs)("span",{className:"text-[10px] text-slate-400",children:[e.source," · ",e.date]})]})]}),(0,s.jsxs)("p",{className:"text-[11px] text-slate-500 bg-slate-50 p-2 rounded mb-2 border border-slate-100",children:[(0,s.jsx)("span",{className:"font-semibold text-slate-400 mr-1",children:"话术："}),e.summary]}),(0,s.jsxs)("div",{className:"flex gap-2",children:[(0,s.jsxs)("button",{className:"flex-1 text-[10px] font-medium bg-white border border-slate-200 py-1.5 rounded text-slate-600 hover:text-brand-600 hover:border-brand-200 transition-colors flex items-center justify-center gap-1",children:[(0,s.jsx)(C.ExternalLink,{size:10})," 预览"]}),(0,s.jsxs)("button",{className:"flex-1 text-[10px] font-bold bg-brand-50 border border-brand-100 py-1.5 rounded text-brand-700 hover:bg-brand-100 transition-colors flex items-center justify-center gap-1",children:[(0,s.jsx)(_,{size:10})," 发送素材"]})]})]},e.id))})]})}var D=e.i(44328),L=e.i(20313),J=e.i(20755),q=e.i(47167);let V=new Map;function Y(e){let s=V.get(e);return s?s():null}class G{name="mock";async analyzeConversation(e){await new Promise(e=>setTimeout(e,500+500*Math.random()));let s=e.messages[e.messages.length-1],t=s?.content||"",a=this.analyzeSentiment(t),r=this.analyzeIntent(t),n=this.extractKeyPoints(t),i=this.assessRisk(t,a);return{intent:{primary:r.primary,confidence:r.confidence,secondary:r.secondary},sentiment:{overall:a.overall,score:a.score,emotions:a.emotions},keyPoints:n,riskAssessment:{level:i.level,factors:i.factors,suggestions:i.suggestions},suggestedReplies:this.generateSuggestedReplies(r.primary,a.overall),metadata:{model:"mock-v1",provider:"mock",tokensUsed:Math.floor(500*Math.random())+100,processingTime:Math.floor(500*Math.random())+200}}}async healthCheck(){return!0}analyzeSentiment(e){let s=e.toLowerCase(),t=["谢谢","感谢","太好了","满意","期待","开心","喜欢","棒","优秀"].filter(e=>s.includes(e)).length,a=["不满","失望","担心","焦虑","着急","问题","投诉","退","差"].filter(e=>s.includes(e)).length,r=["急","马上","立刻","赶紧","截止","来不及"].filter(e=>s.includes(e)).length,n=[];t>0&&n.push("积极","期待"),a>0&&n.push("担忧","不满"),r>0&&n.push("紧迫","焦虑"),0===n.length&&n.push("平静");let i="neutral",l=0;return t>a?(i="positive",l=Math.min(.3+.2*t,1)):a>t?(i="negative",l=Math.max(-.3-.2*a,-1)):t>0&&a>0&&(i="mixed",l=0),{overall:i,score:l,emotions:n}}analyzeIntent(e){let s=e.toLowerCase(),t="一般咨询",a=.6,r=[];for(let e of[{keywords:["截止","日期","时间","什么时候","多久"],intent:"询问时间节点",confidence:.85},{keywords:["费用","价格","多少钱","收费","预算"],intent:"咨询费用",confidence:.9},{keywords:["进度","怎么样","到哪了","状态"],intent:"询问进度",confidence:.85},{keywords:["文书","申请","材料","资料"],intent:"询问申请材料",confidence:.8},{keywords:["推荐","建议","哪个好","怎么选"],intent:"寻求建议",confidence:.8},{keywords:["问题","不对","错了","修改"],intent:"反馈问题",confidence:.85},{keywords:["谢谢","感谢","辛苦"],intent:"表达感谢",confidence:.9},{keywords:["你好","在吗","请问"],intent:"打招呼",confidence:.95}])e.keywords.filter(e=>s.includes(e)).length>0&&(e.confidence>a?("一般咨询"!==t&&r.push(t),t=e.intent,a=e.confidence):r.push(e.intent));return{primary:t,confidence:a,secondary:r.slice(0,2)}}extractKeyPoints(e){let s=[];return/截止|deadline|ddl|\d+月|\d+号/i.test(e)&&s.push({topic:"时间节点",importance:"high",context:"客户关注具体时间安排"}),/费用|价格|收费|钱|预算/i.test(e)&&s.push({topic:"费用咨询",importance:"high",context:"客户关注服务费用"}),/进度|状态|怎么样|到哪/i.test(e)&&s.push({topic:"进度跟进",importance:"medium",context:"客户关心当前进展"}),/文书|essay|ps|cv|推荐信/i.test(e)&&s.push({topic:"文书材料",importance:"high",context:"涉及申请核心材料"}),0===s.length&&s.push({topic:"日常沟通",importance:"low",context:"常规客户互动"}),s}assessRisk(e,s){let t=[],a=[],r="low";return"negative"===s.overall&&(t.push("客户情绪偏负面"),a.push("注意安抚客户情绪"),r="medium"),/急|马上|立刻|来不及/i.test(e)&&(t.push("客户表达紧迫感"),a.push("优先处理，及时响应"),r="medium"===r?"high":"medium"),/投诉|不满|差评|退款/i.test(e)&&(t.push("潜在投诉风险"),a.push("升级处理，主管介入"),r="high"),/考虑|其他|别家|不想/i.test(e)&&(t.push("客户可能流失"),a.push("了解原因，挽留客户"),r="low"===r?"medium":r),0===t.length&&(t.push("无明显风险因素"),a.push("保持正常服务节奏")),{level:r,factors:t,suggestions:a}}generateSuggestedReplies(e,s){let t=[];switch(e){case"询问时间节点":t.push({content:"您好！关于时间安排，让我帮您确认一下具体的截止日期，稍后给您详细说明。",tone:"专业",priority:1});break;case"询问进度":t.push({content:"您好！目前您的申请进度正在顺利推进中，我来给您详细汇报一下当前状态。",tone:"亲切",priority:1});break;case"咨询费用":t.push({content:"您好！感谢您的咨询。关于费用方面，我来给您详细介绍一下我们的服务套餐和价格。",tone:"专业",priority:1});break;case"反馈问题":t.push({content:"非常感谢您的反馈！我已经记录下您提到的问题，会尽快处理并给您回复。",tone:"诚恳",priority:1});break;default:t.push({content:"您好！感谢您的消息，我来为您解答。",tone:"亲切",priority:1})}return"negative"===s&&t.push({content:"非常理解您的心情，我们一定会尽全力为您解决。请放心，您的问题我们会优先处理。",tone:"安抚",priority:2}),t}}class H{name="openai";config;constructor(e){this.config={apiKey:e?.apiKey||q.default.env.OPENAI_API_KEY,baseUrl:e?.baseUrl||"https://api.openai.com/v1",model:e?.model||"gpt-4o-mini",maxTokens:e?.maxTokens||2e3,temperature:e?.temperature||.3,timeout:e?.timeout||3e4}}async analyzeConversation(e){if(!this.config.apiKey)throw Error("OpenAI API key not configured");let s=Date.now(),t=this.buildSystemPrompt(),a=this.buildUserPrompt(e),r=await fetch(`${this.config.baseUrl}/chat/completions`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${this.config.apiKey}`},body:JSON.stringify({model:this.config.model,messages:[{role:"system",content:t},{role:"user",content:a}],max_tokens:this.config.maxTokens,temperature:this.config.temperature,response_format:{type:"json_object"}}),signal:AbortSignal.timeout(this.config.timeout)});if(!r.ok){let e=await r.text();throw Error(`OpenAI API error: ${r.status} - ${e}`)}let n=await r.json(),i=n.choices?.[0]?.message?.content;if(!i)throw Error("Empty response from OpenAI");let l=JSON.parse(i),o=Date.now()-s;return{intent:{primary:l.intent?.primary||"一般咨询",confidence:l.intent?.confidence||.7,secondary:l.intent?.secondary||[]},sentiment:{overall:l.sentiment?.overall||"neutral",score:l.sentiment?.score||0,emotions:l.sentiment?.emotions||[]},keyPoints:l.keyPoints||[],riskAssessment:{level:l.riskAssessment?.level||"low",factors:l.riskAssessment?.factors||[],suggestions:l.riskAssessment?.suggestions||[]},suggestedReplies:l.suggestedReplies||[],metadata:{model:this.config.model,provider:"openai",tokensUsed:n.usage?.total_tokens,processingTime:o}}}async healthCheck(){if(!this.config.apiKey)return!1;try{return(await fetch(`${this.config.baseUrl}/models`,{headers:{Authorization:`Bearer ${this.config.apiKey}`},signal:AbortSignal.timeout(5e3)})).ok}catch{return!1}}buildSystemPrompt(){return`你是一个专业的客户服务分析助手，专门为留学咨询机构分析企业微信会话。

你的任务是分析客户会话并提供以下信息：
1. 意图分析：识别客户的主要和次要意图
2. 情绪分析：评估客户的情绪状态
3. 关键点提取：提取会话中的重要信息
4. 风险评估：识别潜在的服务风险
5. 建议回复：提供专业的回复建议

请以 JSON 格式返回分析结果，结构如下：
{
  "intent": {
    "primary": "主要意图",
    "confidence": 0.85,
    "secondary": ["次要意图1", "次要意图2"]
  },
  "sentiment": {
    "overall": "positive|neutral|negative|mixed",
    "score": 0.5,
    "emotions": ["期待", "焦虑"]
  },
  "keyPoints": [
    {
      "topic": "关键主题",
      "importance": "high|medium|low",
      "context": "上下文说明"
    }
  ],
  "riskAssessment": {
    "level": "low|medium|high|critical",
    "factors": ["风险因素"],
    "suggestions": ["建议措施"]
  },
  "suggestedReplies": [
    {
      "content": "建议回复内容",
      "tone": "专业|亲切|安抚",
      "priority": 1
    }
  ]
}

注意事项：
- 意图置信度范围 0-1
- 情绪分数范围 -1 到 1（-1 最负面，1 最正面）
- 回复建议要符合留学咨询的专业场景
- 关注时间节点、费用、进度等敏感话题`}buildUserPrompt(e){let s="请分析以下会话：\n\n";for(let t of(e.context&&(s+="【客户背景】\n",e.context.customerName&&(s+=`客户姓名：${e.context.customerName}
`),e.context.customerStage&&(s+=`服务阶段：${e.context.customerStage}
`),e.context.customerTags?.length&&(s+=`客户标签：${e.context.customerTags.join(", ")}
`),s+="\n"),s+="【会话内容】\n",e.messages)){let e=t.senderName||("user"===t.role?"客户":"顾问");s+=`${e}：${t.content}
`}return s}}class Q{name="anthropic";config;constructor(e){this.config={apiKey:e?.apiKey||q.default.env.ANTHROPIC_API_KEY,baseUrl:e?.baseUrl||"https://api.anthropic.com/v1",model:e?.model||"claude-3-haiku-20240307",maxTokens:e?.maxTokens||2e3,temperature:e?.temperature||.3,timeout:e?.timeout||3e4}}async analyzeConversation(e){if(!this.config.apiKey)throw Error("Anthropic API key not configured");let s=Date.now(),t=this.buildSystemPrompt(),a=this.buildUserPrompt(e),r=await fetch(`${this.config.baseUrl}/messages`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.config.apiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:this.config.model,max_tokens:this.config.maxTokens,temperature:this.config.temperature,system:t,messages:[{role:"user",content:a}]}),signal:AbortSignal.timeout(this.config.timeout)});if(!r.ok){let e=await r.text();throw Error(`Anthropic API error: ${r.status} - ${e}`)}let n=await r.json(),i=n.content?.[0]?.text;if(!i)throw Error("Empty response from Anthropic");let l=i.match(/\{[\s\S]*\}/);if(!l)throw Error("Failed to parse JSON from Anthropic response");let o=JSON.parse(l[0]),c=Date.now()-s;return{intent:{primary:o.intent?.primary||"一般咨询",confidence:o.intent?.confidence||.7,secondary:o.intent?.secondary||[]},sentiment:{overall:o.sentiment?.overall||"neutral",score:o.sentiment?.score||0,emotions:o.sentiment?.emotions||[]},keyPoints:o.keyPoints||[],riskAssessment:{level:o.riskAssessment?.level||"low",factors:o.riskAssessment?.factors||[],suggestions:o.riskAssessment?.suggestions||[]},suggestedReplies:o.suggestedReplies||[],metadata:{model:this.config.model,provider:"anthropic",tokensUsed:(n.usage?.input_tokens||0)+(n.usage?.output_tokens||0),processingTime:c}}}async healthCheck(){if(!this.config.apiKey)return!1;try{return(await fetch(`${this.config.baseUrl}/messages`,{method:"POST",headers:{"Content-Type":"application/json","x-api-key":this.config.apiKey,"anthropic-version":"2023-06-01"},body:JSON.stringify({model:this.config.model,max_tokens:10,messages:[{role:"user",content:"hi"}]}),signal:AbortSignal.timeout(5e3)})).ok}catch{return!1}}buildSystemPrompt(){return`你是一个专业的客户服务分析助手，专门为留学咨询机构分析企业微信会话。

你的任务是分析客户会话并提供以下信息：
1. 意图分析：识别客户的主要和次要意图
2. 情绪分析：评估客户的情绪状态
3. 关键点提取：提取会话中的重要信息
4. 风险评估：识别潜在的服务风险
5. 建议回复：提供专业的回复建议

请以 JSON 格式返回分析结果，结构如下：
{
  "intent": {
    "primary": "主要意图",
    "confidence": 0.85,
    "secondary": ["次要意图1", "次要意图2"]
  },
  "sentiment": {
    "overall": "positive|neutral|negative|mixed",
    "score": 0.5,
    "emotions": ["期待", "焦虑"]
  },
  "keyPoints": [
    {
      "topic": "关键主题",
      "importance": "high|medium|low",
      "context": "上下文说明"
    }
  ],
  "riskAssessment": {
    "level": "low|medium|high|critical",
    "factors": ["风险因素"],
    "suggestions": ["建议措施"]
  },
  "suggestedReplies": [
    {
      "content": "建议回复内容",
      "tone": "专业|亲切|安抚",
      "priority": 1
    }
  ]
}

注意事项：
- 意图置信度范围 0-1
- 情绪分数范围 -1 到 1（-1 最负面，1 最正面）
- 回复建议要符合留学咨询的专业场景
- 只返回 JSON，不要有其他文字`}buildUserPrompt(e){let s="请分析以下会话：\n\n";for(let t of(e.context&&(s+="【客户背景】\n",e.context.customerName&&(s+=`客户姓名：${e.context.customerName}
`),e.context.customerStage&&(s+=`服务阶段：${e.context.customerStage}
`),e.context.customerTags?.length&&(s+=`客户标签：${e.context.customerTags.join(", ")}
`),s+="\n"),s+="【会话内容】\n",e.messages)){let e=t.senderName||("user"===t.role?"客户":"顾问");s+=`${e}：${t.content}
`}return s}}async function X(e,s,t){let{forceRefresh:a=!1,context:r}=t||{},n=s[s.length-1]?.id||"empty",i=`${e}:${n}`;if(!a){let e=await Z(i);if(e.success&&e.data)return console.log("[AI] Using cached analysis:",i),(0,D.success)(e.data.analysis)}console.log("[AI] Triggering AI analysis:",i);let l=await W(e,s,r);if(!l.success)return(0,D.failure)(l.error);let o=await ee(e,i,l.data);return o.success||console.warn("[AI] Failed to save analysis to DB:",o.error),(0,D.success)(l.data)}async function Z(e){let s=(0,J.createClient)();try{var t;let{data:a,error:r}=await s.from("conversation_analyses").select("*").eq("idempotency_key",e).single();if(r){if("PGRST116"===r.code)return(0,D.success)(null);if("42P01"===r.code||r.message.includes("does not exist"))return console.warn("[AI] conversation_analyses table not exists"),(0,D.success)(null);return(0,D.failure)((0,D.createServiceError)(r,"获取分析结果失败"))}return(0,D.success)({id:(t=a).id,conversationId:t.conversation_id,idempotencyKey:t.idempotency_key,analysis:{intent:{primary:t.intent_primary,confidence:t.intent_confidence,secondary:t.intent_secondary||void 0},sentiment:{overall:t.sentiment_overall,score:t.sentiment_score,emotions:t.sentiment_emotions||[]},keyPoints:t.key_points||[],riskAssessment:{level:t.risk_level,factors:t.risk_factors||[],suggestions:t.risk_suggestions||[]},suggestedReplies:t.suggested_replies||[],metadata:{provider:t.ai_provider,model:t.ai_model,tokensUsed:t.tokens_used||void 0,processingTime:t.processing_time_ms||void 0}},createdAt:t.created_at,updatedAt:t.updated_at})}catch(e){return console.error("getAnalysisFromDB error:",e),(0,D.success)(null)}}async function W(e,s,t){try{let a=function(){let e=Y(q.default.env.NEXT_PUBLIC_AI_PROVIDER||"openai");if(e)return e;let s=Y("mock");if(s)return s;throw Error("No AI provider available")}(),r={conversationId:e,messages:s.map(e=>({role:e.isMe?"assistant":"user",content:e.content,timestamp:e.timestamp,senderName:e.senderName})),context:t},n=await a.analyzeConversation(r);return(0,D.success)(n)}catch(e){return console.error("AI analysis error:",e),(0,D.failure)((0,D.createServiceError)(e,"AI 分析失败"))}}async function ee(e,s,t){let a=(0,J.createClient)();try{let r={conversation_id:e,idempotency_key:s,intent_primary:t.intent.primary,intent_confidence:t.intent.confidence,intent_secondary:t.intent.secondary||null,sentiment_overall:t.sentiment.overall,sentiment_score:t.sentiment.score,sentiment_emotions:t.sentiment.emotions||null,key_points:t.keyPoints||null,risk_level:t.riskAssessment.level,risk_factors:t.riskAssessment.factors||null,risk_suggestions:t.riskAssessment.suggestions||null,suggested_replies:t.suggestedReplies||null,ai_provider:t.metadata.provider,ai_model:t.metadata.model,tokens_used:t.metadata.tokensUsed||null,processing_time_ms:t.metadata.processingTime||null},{error:n}=await a.from("conversation_analyses").upsert(r,{onConflict:"idempotency_key"});if(n)return console.error("Save analysis error:",n),(0,D.failure)((0,D.createServiceError)(n,"保存分析结果失败"));return(0,D.success)(void 0)}catch(e){return(0,D.failure)((0,D.createServiceError)(e,"保存分析结果失败"))}}function es(){let e=(0,D.useToast)(),[a,r]=(0,t.useState)([]),[n,i]=(0,t.useState)([]),[l,c]=(0,t.useState)(null),[d,m]=(0,t.useState)([]),[x,u]=(0,t.useState)(!1),[h,p]=(0,t.useState)(null),[g,b]=(0,t.useState)("all"),[y,v]=(0,t.useState)(""),[j,N]=(0,t.useState)("profile"),[k,w]=(0,t.useState)(""),[A,S]=(0,t.useState)(!0),[_,C]=(0,t.useState)(!1),[T,z]=(0,t.useState)(!1);(0,t.useEffect)(()=>{(async()=>{S(!0);let s=await (0,L.getConversationList)({type:g});s.success?(r(s.data.data),s.data.data.length>0&&!h&&p(s.data.data[0].id)):(e.error("加载会话列表失败",s.error.message),r([])),S(!1)})()},[g]),(0,t.useEffect)(()=>{h&&(async()=>{C(!0),c(null);let[s,t]=await Promise.all([(0,L.getConversationMessages)(h),(0,L.getMarketingMaterials)()]);s.success?(i(s.data.data),u(s.data.hasMore),P(h,s.data.data)):(e.error("加载消息失败",s.error.message),i([])),t.success&&m(t.data),C(!1)})()},[h]);let P=async(e,s)=>{if(0===s.length)return;z(!0);let t=a.find(s=>s.id===e),r=await X(e,s,{context:t?{customerName:t.name,customerStage:t.serviceStage,customerTags:t.tags}:void 0});r.success?c(r.data):console.warn("AI analysis failed:",r.error),z(!1)},M=async()=>{if(!h||0===n.length)return;z(!0);let s=a.find(e=>e.id===h),t=await X(h,n,{forceRefresh:!0,context:s?{customerName:s.name,customerStage:s.serviceStage,customerTags:s.tags}:void 0});t.success?(c(t.data),e.success("分析完成","AI 分析已更新")):e.error("分析失败",t.error.message),z(!1)},$=a.filter(e=>!y||e.name.toLowerCase().includes(y.toLowerCase())),U=a.find(e=>e.id===h)||null;return(0,s.jsxs)("div",{className:"flex h-[calc(100vh-64px)] overflow-hidden bg-white",children:[(0,s.jsx)(o,{conversations:$,selectedId:h,onSelect:p,filter:g,onFilterChange:b,searchQuery:y,onSearchChange:v}),(0,s.jsx)(f,{conversation:U,messages:n,draft:k,onDraftChange:w,onCopyDraft:()=>{k&&(navigator.clipboard.writeText(k),e.success("已复制","内容已复制到剪贴板"))}}),(0,s.jsx)(I,{conversation:U,aiAnalysis:l,materials:d,activeTab:j,onTabChange:N,onUseScript:e=>{w(e)},onRefreshAnalysis:M,isAnalysisLoading:T})]})}V.set("mock",()=>new G),V.set("openai",()=>new H),V.set("anthropic",()=>new Q),e.s(["default",()=>es],73079)}]);