module.exports=[29334,a=>{"use strict";var b=a.i(87924),c=a.i(72131),d=a.i(70106);let e=(0,d.default)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]]);var f=a.i(84505),g=a.i(69520),h=a.i(3130),i=a.i(38246),j=a.i(41710),k=a.i(41675),l=a.i(73570);let m=(0,d.default)("Frown",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M16 16s-1.5-2-4-2-4 2-4 2",key:"epbg0q"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]]),n=(0,d.default)("MessageSquareWarning",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v2",key:"stiyo7"}],["path",{d:"M12 13h.01",key:"y0uutt"}]]);var o=a.i(11300),p=a.i(4720),q=a.i(17755),r=a.i(46842),s=a.i(52495),t=a.i(54161),u=a.i(98963);let v={response_timeout:{label:"响应超时",icon:"Clock",color:"text-amber-600"},follow_up_overdue:{label:"跟进逾期",icon:"Calendar",color:"text-orange-600"},service_risk:{label:"服务风险",icon:"AlertTriangle",color:"text-red-600"},negative_sentiment:{label:"负面情绪",icon:"Frown",color:"text-purple-600"},complaint:{label:"投诉预警",icon:"MessageSquareWarning",color:"text-red-700"},task_overdue:{label:"任务逾期",icon:"ClipboardList",color:"text-amber-700"},contract_expiring:{label:"合同到期",icon:"FileText",color:"text-blue-600"}},w={low:{label:"低",color:"text-slate-600",bgColor:"bg-slate-100"},medium:{label:"中",color:"text-amber-600",bgColor:"bg-amber-100"},high:{label:"高",color:"text-orange-600",bgColor:"bg-orange-100"},critical:{label:"紧急",color:"text-red-600",bgColor:"bg-red-100"}},x={pending:{label:"待处理",color:"text-amber-600"},processing:{label:"处理中",color:"text-blue-600"},resolved:{label:"已解决",color:"text-emerald-600"},ignored:{label:"已忽略",color:"text-slate-400"}},y={Clock:j.Clock,Calendar:k.Calendar,AlertTriangle:l.AlertTriangle,Frown:m,MessageSquareWarning:n,ClipboardList:o.ClipboardList,FileText:p.FileText};function z({alerts:a,onAlertClick:c,onResolve:d,emptyTitle:e="暂无预警",emptyDescription:f="当前没有需要处理的预警"}){return 0===a.length?(0,b.jsx)(u.EmptyState,{variant:"default",title:e,description:f,icon:l.AlertTriangle}):(0,b.jsx)("div",{className:"divide-y divide-slate-100",children:a.map(a=>(0,b.jsx)(A,{alert:a,onClick:()=>c?.(a),onResolve:()=>d?.(a)},a.id))})}function A({alert:a,onClick:c,onResolve:d}){let e=v[a.type],f=w[a.severity],g=x[a.status],h=y[e.icon]||l.AlertTriangle;return(0,b.jsx)("div",{className:`p-4 hover:bg-slate-50 transition-colors cursor-pointer ${"resolved"===a.status?"opacity-60":""}`,onClick:c,children:(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[(0,b.jsx)("div",{className:`w-10 h-10 rounded-xl flex items-center justify-center ${f.bgColor}`,children:(0,b.jsx)(h,{size:20,className:f.color})}),(0,b.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,b.jsxs)("div",{className:"flex items-center gap-2 mb-1",children:[(0,b.jsx)("h4",{className:"font-medium text-slate-900 truncate",children:a.title}),(0,b.jsx)(t.Badge,{variant:"outline",className:`text-[10px] ${f.color}`,children:f.label}),(0,b.jsx)(t.Badge,{variant:"secondary",className:`text-[10px] ${g.color}`,children:g.label})]}),(0,b.jsx)("p",{className:"text-sm text-slate-500 mb-2",children:a.description}),(0,b.jsxs)("div",{className:"flex items-center gap-4 text-xs text-slate-400",children:[(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(j.Clock,{size:12}),a.createdAt]}),a.assignee&&(0,b.jsxs)("span",{className:"flex items-center gap-1",children:[(0,b.jsx)(r.User,{size:12}),a.assignee]}),(0,b.jsxs)(i.default,{href:`/${"conversation"===a.relatedType?"messages":"customer"===a.relatedType?"sales/customers/"+a.relatedId:"projects"}`,className:"flex items-center gap-1 text-brand-600 hover:text-brand-700",onClick:a=>a.stopPropagation(),children:[(0,b.jsx)(s.ExternalLink,{size:12}),a.relatedName]})]})]}),(0,b.jsxs)("div",{className:"flex items-center gap-2",onClick:a=>a.stopPropagation(),children:["pending"===a.status&&(0,b.jsx)("button",{onClick:d,className:"px-3 py-1.5 text-xs font-medium bg-brand-50 text-brand-700 rounded-lg hover:bg-brand-100 transition-colors",children:"处理"}),(0,b.jsx)("button",{className:"p-1.5 text-slate-400 hover:text-slate-600 hover:bg-slate-100 rounded",children:(0,b.jsx)(q.MoreHorizontal,{size:16})})]})]})})}let B=(0,d.default)("ArrowUpRight",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]),C=(0,d.default)("ArrowDownRight",[["path",{d:"m7 7 10 10",key:"1fmybs"}],["path",{d:"M17 7v10H7",key:"6fjiku"}]]);function D({metrics:a}){return(0,b.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:a.map((a,c)=>(0,b.jsx)(E,{metric:a},c))})}function E({metric:a}){return(0,b.jsx)(h.Card,{className:"hover:shadow-md transition-shadow",children:(0,b.jsxs)(h.CardContent,{className:"p-5",children:[(0,b.jsx)("div",{className:"text-slate-500 text-sm font-medium mb-1",children:a.label}),(0,b.jsxs)("div",{className:"flex items-end justify-between",children:[(0,b.jsxs)("div",{children:[(0,b.jsx)("span",{className:`text-3xl font-bold ${a.color||"text-slate-900"}`,children:a.value}),void 0!==a.total&&(0,b.jsxs)("span",{className:"text-lg text-slate-400 ml-1",children:["/ ",a.total]})]}),void 0!==a.change&&a.trend&&(0,b.jsxs)("div",{className:`text-xs font-medium flex items-center gap-1 ${"up"===a.trend?"text-red-500":"down"===a.trend?"text-emerald-600":"text-slate-500"}`,children:["up"===a.trend?(0,b.jsx)(B,{size:14}):"down"===a.trend?(0,b.jsx)(C,{size:14}):null,a.change>0?"+":"",a.change]})]})]})})}var F=a.i(210),G=a.i(40695);function H({title:a,description:c,backHref:d,badges:e,actions:f,children:g,className:h=""}){return(0,b.jsxs)("div",{className:`px-6 py-5 bg-white border-b border-slate-200 shadow-sm ${h}`,children:[(0,b.jsxs)("div",{className:"flex justify-between items-start gap-4",children:[(0,b.jsxs)("div",{className:"flex items-start gap-4",children:[d&&(0,b.jsx)(i.default,{href:d,className:"p-2 hover:bg-slate-100 rounded-lg transition-colors mt-0.5",children:(0,b.jsx)(F.ArrowLeft,{size:20,className:"text-slate-600"})}),(0,b.jsxs)("div",{children:[(0,b.jsxs)("div",{className:"flex items-center gap-3",children:[(0,b.jsx)("h1",{className:"text-2xl font-bold text-slate-900 tracking-tight",children:a}),e&&e.map((a,c)=>(0,b.jsx)(t.Badge,{variant:a.variant,children:a.label},c))]}),c&&(0,b.jsx)("p",{className:"text-sm text-slate-500 mt-1",children:c})]})]}),f&&f.length>0&&(0,b.jsx)("div",{className:"flex gap-3",children:f.map((a,c)=>{let d=a.icon,e=(0,b.jsxs)(G.Button,{variant:a.variant||"default",onClick:a.onClick,children:[d&&(0,b.jsx)(d,{size:16,className:"mr-2"}),a.label]},c);return a.href?(0,b.jsx)(i.default,{href:a.href,children:e},c):e})})]}),g]})}var I=a.i(9444),J=a.i(75384);function K(){let a=(0,I.useToast)(),[d,i]=(0,c.useState)([]),[j,k]=(0,c.useState)([]),[l,m]=(0,c.useState)(!0),[n,o]=(0,c.useState)("all"),[p,q]=(0,c.useState)("all"),[r,s]=(0,c.useState)("pending");(0,c.useEffect)(()=>{t()},[n,p,r]);let t=async()=>{m(!0);let[b,c]=await Promise.all([(0,J.getQualityAlerts)({type:n,severity:p,status:r}),(0,J.getQualityMetrics)()]);b.success?i(b.data):(a.error("加载预警列表失败",b.error.message),i([])),c.success?k(c.data):k([]),m(!1)},u=async b=>{let c=await (0,J.resolveAlert)({alertId:b.id});c.success?(a.success("处理成功",`预警 "${b.title}" 已标记为已处理`),t()):a.error("处理失败",c.error.message)},x="all"!==n||"all"!==p||"pending"!==r;return(0,b.jsxs)("div",{className:"min-h-[calc(100vh-64px)] bg-slate-50/50",children:[(0,b.jsx)(H,{title:"管理质检中心",description:"监控服务质量，及时处理风险预警",actions:[{label:"导出报告",icon:f.Download,variant:"outline",onClick:()=>console.log("Export")},{label:"刷新",icon:g.RefreshCw,variant:"outline",onClick:()=>{t(),a.info("刷新中","正在重新加载数据")}}]}),(0,b.jsxs)("div",{className:"p-6 space-y-6",children:[(0,b.jsx)(D,{metrics:j}),(0,b.jsxs)(h.Card,{className:"border-0 shadow-sm ring-1 ring-slate-200",children:[(0,b.jsx)(h.CardHeader,{className:"border-b border-slate-100",children:(0,b.jsxs)("div",{className:"flex items-center justify-between",children:[(0,b.jsxs)(h.CardTitle,{className:"flex items-center gap-2",children:[(0,b.jsx)(e,{size:18,className:"text-brand-600"}),"风险预警列表"]}),(0,b.jsx)("div",{className:"flex items-center gap-3",children:(0,b.jsx)("div",{className:"flex items-center gap-1 bg-slate-100 p-1 rounded-lg",children:[{key:"pending",label:"待处理"},{key:"processing",label:"处理中"},{key:"resolved",label:"已解决"},{key:"all",label:"全部"}].map(a=>(0,b.jsx)("button",{onClick:()=>s(a.key),className:`px-3 py-1 text-xs font-medium rounded-md transition-all ${r===a.key?"bg-white text-slate-900 shadow-sm":"text-slate-500 hover:text-slate-900"}`,children:a.label},a.key))})})]})}),(0,b.jsxs)("div",{className:"px-6 py-3 border-b border-slate-100 bg-slate-50/50 flex items-center gap-3",children:[(0,b.jsxs)("select",{value:n,onChange:a=>o(a.target.value),className:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none focus:ring-2 focus:ring-brand-500",children:[(0,b.jsx)("option",{value:"all",children:"全部类型"}),Object.entries(v).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c.label},a))]}),(0,b.jsxs)("select",{value:p,onChange:a=>q(a.target.value),className:"px-3 py-1.5 bg-white border border-slate-200 rounded-lg text-sm text-slate-600 focus:outline-none focus:ring-2 focus:ring-brand-500",children:[(0,b.jsx)("option",{value:"all",children:"全部严重程度"}),Object.entries(w).map(([a,c])=>(0,b.jsx)("option",{value:a,children:c.label},a))]}),x&&(0,b.jsx)("button",{onClick:()=>{o("all"),q("all"),s("pending")},className:"text-sm text-brand-600 hover:text-brand-700 font-medium",children:"重置筛选"}),(0,b.jsx)("div",{className:"flex-1"}),(0,b.jsxs)("span",{className:"text-sm text-slate-500",children:["共 ",(0,b.jsx)("span",{className:"font-medium text-slate-900",children:d.length})," 条预警"]})]}),(0,b.jsx)(h.CardContent,{className:"p-0",children:l?(0,b.jsx)("div",{className:"flex items-center justify-center h-64",children:(0,b.jsx)("div",{className:"animate-spin w-8 h-8 border-2 border-brand-500 border-t-transparent rounded-full"})}):(0,b.jsx)(z,{alerts:d,onAlertClick:a=>console.log("Click alert:",a.id),onResolve:u,emptyTitle:x?"没有找到匹配的预警":"暂无待处理预警",emptyDescription:x?"尝试调整筛选条件":"当前没有需要处理的风险预警"})})]})]})]})}a.s(["default",()=>K],29334)}];

//# sourceMappingURL=app_%28protected%29_quality_page_tsx_db41d386._.js.map